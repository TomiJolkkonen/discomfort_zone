# Penetration Testing Cheat Sheet

## Information Gathering
### Passive Reconnaissance
- `whois target.com` - Domain info
- `nslookup target.com` - Name server lookup
- `theHarvester -d target.com -l 500 -b google` - Gather emails, subdomains
- `Shodan.io` - Internet-wide scan database

### Active Reconnaissance
- `nmap -sV -sC -A target` - Service detection, default scripts, OS detection
- `nikto -h target.com` - Web server vulnerability scanner
- `gobuster dir -u http://target.com -w wordlist.txt` - Directory bruteforce

## Scanning & Enumeration
- `nmap -p- -T4 -A -v target` - Full port scan
- `enum4linux -a target` - Enumerate SMB shares
- `snmpwalk -v2c -c public target` - SNMP Enumeration

## Exploitation
### Web Exploits
- `sqlmap -u "http://target.com/page?id=1" --dbs` - SQL Injection detection
- `xsser --url="http://target.com/page.php?param=value"` - XSS detection
- `wfuzz -c -z file,wordlist.txt --hc 404 http://target.com/FUZZ` - Fuzzing

### System Exploits
- `searchsploit target_software` - Search for exploits
- `msfconsole` - Start Metasploit
- `exploit/multi/http/struts2_exec` - Example Metasploit exploit module

## Privilege Escalation
### Linux
- `sudo -l` - Check sudo permissions
- `find / -perm -4000 2>/dev/null` - SUID binaries
- `cat /etc/passwd | grep bash` - Check user accounts

### Windows
- `whoami /priv` - Check privileges
- `wmic qfe get Caption,Description,HotFixID,InstalledOn` - Check patches
- `winPEAS.exe` - Automated privilege escalation enumeration

## Post Exploitation
### Persistence
- `crontab -e` - Add a malicious cron job (Linux)
- `schtasks /create /sc minute /tn backdoor /tr C:\backdoor.exe` - Scheduled task (Windows)

### Lateral Movement
- `smbclient -L target -U user` - List SMB shares
- `psexec.py user@target` - Execute commands on remote Windows

## Password Cracking
- `john --wordlist=rockyou.txt hashes.txt` - Crack password hashes
- `hashcat -m 1000 -a 0 hash.txt wordlist.txt` - NTLM hash cracking

## Covering Tracks
- `shred -u log_file` - Securely delete files (Linux)
- `wevtutil cl System` - Clear Windows event logs

---
This cheat sheet provides a concise list of useful penetration testing commands. Always obtain proper authorization before testing any system.
